<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mon Panier - Standing CARA√èBES RENT'</title>
    <link rel="stylesheet" href="../css/style.css">
    <style>
        /* Styles sp√©cifiques au panier */
        .panier-container { max-width: 800px; margin: 40px auto; padding: 20px; min-height: 300px;}
        .article-panier { 
            background: #fff; border: 1px solid #ddd; padding: 20px; margin-bottom: 15px; 
            border-radius: 8px; display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }
        /* Bouton de validation WhatsApp */
        .btn-valider {
            background-color: #25D366; /* Vert WhatsApp */
            color: white; border: none; padding: 15px 30px; 
            font-size: 1.2em; border-radius: 50px; cursor: pointer; 
            display: block; width: 100%; max-width: 400px; margin: 20px auto;
            font-weight: bold; text-transform: uppercase;
            box-shadow: 0 4px 15px rgba(37, 211, 102, 0.4);
            transition: transform 0.2s;
            text-decoration: none; text-align: center;
        }
        .btn-valider:hover { transform: scale(1.05); background-color: #1ebe57; }
    </style>
</head>
<body>

    <header>
        <div class="header-brand">
            <h1>STANDING CARA√èBES RENT'</h1>
            <img src="../Images/logo2.png" alt="Logo Standing Cara√Øbes" class="logo-img">
        </div>

        <nav>
            <ul>
                <li><a href="../index.html">Accueil</a></li>
                <li><a href="../index.html">Location V√©hicules</a></li>
                <li><a href="excursions.html">Excursions Bateau</a></li>
                <li><a href="../html/evenementiel.html">√âv√©nementiel</a></li>
                <li><a href="#produits-locaux">Produits Locaux</a></li>
                <li><a href="../html/panier.html" style="color:#ffd700;">üõí Mon Panier</a></li>
            </ul>
        </nav>
    </header>

    <section id="panier-section">
        <h2 style="text-align:center; margin-top:40px;">Votre R√©servation</h2>
        
        <div id="contenu-panier" class="panier-container">
            <p style="text-align:center;">Votre panier est vide.</p>
        </div>

        <div id="total-block" style="display:none; max-width:800px; margin:0 auto; padding:20px;">
            <div style="text-align:right; font-size:1.5rem; margin-bottom:20px;">
                Total estim√© : <span id="prix-total" style="color:#0056b3; font-weight:bold;">0 ‚Ç¨</span>
            </div>

            <div style="text-align:center; background:#f9f9f9; padding:30px; border-radius:15px;">
                <h3 style="color:#0a2351;">Valider ma r√©servation</h3>
                <p>Cliquez ci-dessous pour envoyer votre demande de r√©servation directement sur notre WhatsApp. Nous vous confirmerons la disponibilit√© imm√©diatement.</p>
                
                <a id="lien-whatsapp" href="#" class="btn-valider">
                    Envoyer la demande via WhatsApp üìû
                </a>
                
                <br>
                <button onclick="viderPanier()" style="background:none; border:none; text-decoration:underline; cursor:pointer; color:#888;">Vider le panier</button>
            </div>
        </div>

    </section>

    <footer>
        <p>&copy; 2025 Standing CARA√èBES RENT'. Tous droits r√©serv√©s.</p>
    </footer>

    <script>
        // CONFIGURATION : Mettez votre num√©ro de t√©l√©phone ici (Format international sans le +)
        // Exemple pour la Guadeloupe (+590) : 590690123456
        const NUMERO_WHATSAPP = "590690409686"; 

        document.addEventListener('DOMContentLoaded', function() {
            const panier = JSON.parse(localStorage.getItem('monPanier')) || [];
            const container = document.getElementById('contenu-panier');
            const totalBlock = document.getElementById('total-block');
            const totalSpan = document.getElementById('prix-total');
            const btnWhatsApp = document.getElementById('lien-whatsapp');
            
            let montantTotal = 0;
            let messageDetails = "";

            if (panier.length > 0) {
                container.innerHTML = '';
                
                panier.forEach((article, index) => {
                    let prix = parseFloat(article.prixTotal || article.prix); // S√©curit√© nom variable
                    montantTotal += prix;
                    
                    // On construit le message pour WhatsApp en m√™me temps
                    messageDetails += `- ${article.titre} du ${article.debut} au ${article.fin} (${prix}‚Ç¨)%0A`;

                    // Affichage HTML
                    const div = document.createElement('div');
                    div.className = 'article-panier';
                    div.innerHTML = `
                        <div style="flex:1">
                            <h3>${article.titre}</h3>
                            <p>Dates : Du <strong>${article.debut}</strong> au <strong>${article.fin}</strong></p>
                        </div>
                        <div style="text-align:right">
                            <p style="color:#0056b3; font-weight:bold; font-size:1.2rem;">${prix} ‚Ç¨</p>
                            <button onclick="supprimerArticle(${index})" style="background:#ff4444; color:white; border:none; padding:5px 10px; cursor:pointer; border-radius:4px;">Supprimer</button>
                        </div>
                    `;
                    container.appendChild(div);
                });

                // Mise √† jour du Total
                totalSpan.textContent = montantTotal + " ‚Ç¨";
                totalBlock.style.display = 'block';

                // Cr√©ation du lien WhatsApp Dynamique
                // %0A veut dire "Saut de ligne"
                let texteFinal = `Bonjour, je souhaite r√©server :%0A%0A${messageDetails}%0ATotal : ${montantTotal}‚Ç¨.%0A%0AMerci de me confirmer la disponibilit√©.`;
                
                btnWhatsApp.href = `https://wa.me/${NUMERO_WHATSAPP}?text=${texteFinal}`;
            }
        });

        function supprimerArticle(index) {
            let panier = JSON.parse(localStorage.getItem('monPanier')) || [];
            panier.splice(index, 1);
            localStorage.setItem('monPanier', JSON.stringify(panier));
            location.reload(); // On recharge la page pour mettre √† jour
        }

        function viderPanier() {
            if(confirm("Voulez-vous vider le panier ?")) {
                localStorage.removeItem('monPanier');
                location.reload();
            }
        }
    </script>
</body>
</html>